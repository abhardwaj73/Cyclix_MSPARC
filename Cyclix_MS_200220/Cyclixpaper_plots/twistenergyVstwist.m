close all
clear
clc

nm2Bohr = 18.89726125;
Ha2eV = 27.211386245988;
%===============================================
% Tw_n = Tw_(n-1) + (n-1) * rate ; n = 1,2, ...
%===============================================

% (13,13) CNT
%----------------

% Radius = 16.6 Bohr, mesh-size=0.15, N_c = 13, N_eta = 40, H = 2.309 Bohr

H1 = 2.3091577619/nm2Bohr;
Nc1 = 13;
ndata1 = 26;
rate1 = 0.0004;
tw_d1 = zeros(ndata1,1);
for i = 2:ndata1
    tw_d1(i) = tw_d1(i-1) + (i-1)*rate1 * nm2Bohr; % input is in rad/nm
end

% Epl_d1 = [ -1.1428424965E+01
%  -1.1428384436E+01
%  -1.1428063035E+01
%  -1.1426964787E+01
%  -1.1424346520E+01
%  -1.1419242866E+01
%  -1.1410491706E+01
%  -1.1396667142E+01
%  -1.1376295720E+01
%  -1.1347833592E+01
%  -1.1310066383E+01
%  -1.1263237423E+01
%  -1.1214338579E+01
%  -1.1176028308E+01
%  -1.1150803212E+01
%  -1.1137673170E+01
%  -1.1139497421E+01
%  -1.1150333041E+01
%  -1.1177641354E+01
%  -1.1204242912E+01
%  -1.1210661311E+01
%  -1.1200312960E+01
%  -1.1190925934E+01
%  -1.1190727385E+01
%  -1.1199830594E+01
%  -1.1201033394E+01
% ] * Ha2eV * Nc1 ; % input is in eV

Epl_d1 = [ -1.1428435296E+01
		   -1.1428396183E+01 
		   -1.1428079751E+01 
		   -1.1426990801E+01 
		   -1.1424375340E+01 
		   -1.1419267712E+01 
		   -1.1410502564E+01 
		   -1.1396680639E+01 
		   -1.1376286631E+01 
		   -1.1347814914E+01 
		   -1.1310052950E+01 
		   -1.1263282746E+01
		   -1.1214377888E+01 
		   -1.1176064688E+01 
		   -1.1150889213E+01 
		   -1.1137796600E+01 
		   -1.1139726121E+01 
		   -1.1150664959E+01 
		   -1.1178144280E+01 
		   -1.1205086656E+01 
		   -1.1211922811E+01
		   -1.1202302815E+01 
		   -1.1193971069E+01 
		   -1.1195226469E+01
		   -1.1206709380E+01
		   -1.1210553427E+01
] * Ha2eV * Nc1/H1 ; % input is in eV/nm

rEpl_d1 = Epl_d1 - Epl_d1(1);

%tw_d1 = tw_d1(2:end);

%rEpl_d1 = rEpl_d1(2:end);

% log_tw_d1 = log10(tw_d1(1:indx_ln));
% log_rEpl_d1 = log10(rEpl_d1(1:indx_ln));
% P_Efit_d1 = polyfit(log_tw_d1,log_rEpl_d1,1);
% Efit_d1 = P_Efit_d1(1)*log_tw_d1 + P_Efit_d1(2);
% antilog_Efit_d1= 10.^(Efit_d1);


% (15,0) CNT
%----------------

% Radius = 11 Bohr, mesh-size=0.15, N_c = 15, N_eta = 23, H = 4.0017685908 Bohr

H2 = 4.0017685908/nm2Bohr;
Nc2 = 15;
ndata2 = 36;
rate2 = 0.0004;
tw_d2 = zeros(ndata2,1);
for i = 2:ndata2
    tw_d2(i) = tw_d2(i-1) + (i-1)*rate2 * nm2Bohr; % input is in rad/nm
end

% Epl_d2 = [ 
% -1.1426121843E+01
%  -1.1426103814E+01
%  -1.1425955836E+01
%  -1.1425454414E+01
%  -1.1424267865E+01
%  -1.1421965078E+01
%  -1.1418072640E+01
%  -1.1411890423E+01
%  -1.1402622667E+01
%  -1.1389479941E+01
%  -1.1371568836E+01
%  -1.1348223839E+01
%  -1.1318524465E+01
%  -1.1281543298E+01
%  -1.1236262872E+01
%  -1.1183570666E+01
%  -1.1124813537E+01
%  -1.1058746551E+01
%  -1.0985405064E+01
%  -1.0910976795E+01
%  -1.0843869042E+01
%  -1.0768920854E+01
%  -1.0662395378E+01
%  -1.0523925956E+01
%  -1.0361466439E+01
%  -1.0194820480E+01
% ] * Ha2eV * Nc2; % input is in eV

Epl_d2 = [ 
		   -1.1426124778E+01
		   -1.1426108296E+01
		   -1.1425962281E+01
		   -1.1425461202E+01
		   -1.1424270782E+01
		   -1.1421963841E+01
		   -1.1418072750E+01 
		   -1.1411889572E+01
		   -1.1402616792E+01
		   -1.1389468564E+01
		   -1.1371562189E+01
		   -1.1348220091E+01
		   -1.1318525027E+01
		   -1.1281562182E+01
		   -1.1236267723E+01 
		   -1.1183595462E+01 
		   -1.1124833276E+01 
		   -1.1058779308E+01 
		   -1.0985453347E+01 
		   -1.0911073023E+01 
		   -1.0844134670E+01 
		   -1.0769490666E+01 
		   -1.0663637642E+01 
		   -1.0526513062E+01 
		   -1.0366551030E+01 
		   -1.0202326085E+01 
		   -1.0062169661E+01 
		   -9.9790976855E+00 
		   -9.9805188107E+00 
		   -1.0074976621E+01 
		   -1.0246002786E+01 
		   -1.0455439251E+01 
		   -1.0656038201E+01 
		   -1.0808647063E+01 
		   -1.0917980061E+01 
		   -1.1053233952E+01 
		   % -1.1185697413E+01 
		   % -1.1303400863E+01 
		   % -1.1384271132E+01 
		   % -1.1415549405E+01 
		   % -1.1389536139E+01 
		   % -1.1303370082E+01 
		   % -1.1158302232E+01 
		   % -1.0969997954E+01 
		   % -1.0797616970E+01 
		   % -1.0700086008E+01 
		   % -9.6262721507E+00 
		   % -5.9361059203E+00 
		   %  5.0846937092E+01 
		   %  7.5484399052E+02
] * Ha2eV * Nc2/H2; % input is in eV/nm

rEpl_d2 = Epl_d2 - Epl_d2(1);

%tw_d2 = tw_d2(2:end);
%rEpl_d2 = rEpl_d2(2:end);

% log_tw_d2 = log10(tw_d2(1:indx_ln));
% log_rEpl_d2 = log10(rEpl_d2(1:indx_ln));
% P_Efit_d2 = polyfit(log_tw_d2,log_rEpl_d2,1);
% Efit_d2 = P_Efit_d2(1)*log_tw_d2 + P_Efit_d2(2);
% antilog_Efit_d2= 10.^(Efit_d2);

% (20,0) CNT
%----------------

% Radius = 14.7 Bohr, mesh-size=0.15, N_c = 20, N_eta = 23, H = 4.0002688791 Bohr

H3 = 4.0002688791/nm2Bohr;
Nc3 = 20;
ndata3 = 33;
rate3 = 0.0004;
tw_d3 = zeros(ndata3,1);
for i = 2:ndata3
    tw_d3(i) = tw_d3(i-1) + (i-1)*rate3 * nm2Bohr; % input is in rad/nm
end

% Epl_d3 = [ 
%  -1.1427970568E+01
%  -1.1427934417E+01
%  -1.1427667042E+01
%  -1.1426781484E+01
%  -1.1424710328E+01
%  -1.1420686490E+01
%  -1.1413712759E+01
%  -1.1402661373E+01
%  -1.1386297838E+01
%  -1.1363238586E+01
%  -1.1332284578E+01
%  -1.1292136757E+01
%  -1.1241160685E+01
%  -1.1180468728E+01
%  -1.1111488215E+01
%  -1.1032413770E+01
%  -1.0945941321E+01
%  -1.0863328254E+01
%  -1.0782191132E+01
%  -1.0661115168E+01
%  -1.0497240572E+01
%  -1.0304333484E+01
%  -1.0117707561E+01
%  -9.9929673661E+00
%  -9.9782249728E+00
%  -1.0061287380E+01
% ] * Ha2eV * Nc3; % input is in eV

Epl_d3 = [ 
 		   -1.1427971686E+01
 		   -1.1427937647E+01
 		   -1.1427673402E+01
 		   -1.1426788211E+01
 		   -1.1424711564E+01
 		   -1.1420686066E+01
 		   -1.1413709857E+01
 		   -1.1402654045E+01
 		   -1.1386290016E+01
 		   -1.1363233791E+01
 		   -1.1332278159E+01
 		   -1.1292156305E+01
 		   -1.1241161129E+01
 		   -1.1180499553E+01
 		   -1.1111497105E+01
 		   -1.1032463653E+01
 		   -1.0945996022E+01
 		   -1.0863531179E+01
 		   -1.0782684675E+01
 		   -1.0662346340E+01
 		   -1.0500160211E+01
 		   -1.0310378605E+01
 		   -1.0125393511E+01
 		   -9.9928564020E+00
 		   -9.9609260431E+00
 		   -1.0053297920E+01
 		   -1.0250768637E+01
 		   -1.0495331410E+01
 		   -1.0715062859E+01
 		   -1.0861061396E+01
 		   -1.1009225853E+01
 		   -1.1167349432E+01
 		   -1.1306060386E+01
] * Ha2eV * Nc3/H3; % input is in eV/nm

rEpl_d3 = Epl_d3 - Epl_d3(1);

%tw_d3 = tw_d3(2:end);
%rEpl_d3 = rEpl_d3(2:end);

% log_tw_d3 = log10(tw_d3(1:indx_ln));
% log_rEpl_d3 = log10(rEpl_d3(1:indx_ln));
% P_Efit_d3 = polyfit(log_tw_d3,log_rEpl_d3,1);
% Efit_d3 = P_Efit_d3(1)*log_tw_d3 + P_Efit_d3(2);
% antilog_Efit_d3= 10.^(Efit_d3);

% (18,12) CNT
%----------------

% Radius = 15.24 Bohr, mesh-size=0.15, N_c = 6, N_eta = 80, H = 1.7325398131 Bohr

H4 = 1.7325398131/nm2Bohr;
Nc4 = 6;
ndata4 = 26;
rate4 = 0.0004;
tw_d4 = zeros(ndata4,1);
for i = 2:ndata4
    tw_d4(i) = tw_d4(i-1) + (i-1)*rate4 * nm2Bohr; % input is in rad/nm
end

Epl_d4 = [ 
 		   -1.1344859500E+01
 		   -1.1344700039E+01
 		   -1.1344129390E+01
 		   -1.1342636191E+01
 		   -1.1339512932E+01
 		   -1.1333862732E+01
 		   -1.1324677966E+01
 		   -1.1311048465E+01
 		   -1.1292020460E+01
 		   -1.1267194402E+01
 		   -1.1236241449E+01
 		   -1.1200911376E+01
 		   -1.1171749066E+01
 		   -1.1150354809E+01
 		   -1.1135604577E+01
 		   -1.1127829087E+01
 		   -1.1124511676E+01
 		   -1.1118089711E+01
 		   -1.1108214706E+01
 		   -1.1100102801E+01
 		   -1.1096834588E+01
 		   -1.1100803820E+01
 		   -1.1115305709E+01
 		   -1.1133269390E+01
 		   -1.1147593416E+01
 		   -1.1157004054E+01
] * Ha2eV * Nc4/H4; % input is in eV/nm

rEpl_d4 = Epl_d4 - Epl_d4(1);

%tw_d4 = tw_d4(2:end);
%rEpl_d4 = rEpl_d4(2:end);

% log_tw_d4 = log10(tw_d4(1:indx_ln));
% log_rEpl_d4 = log10(rEpl_d4(1:indx_ln));
% P_Efit_d4 = polyfit(log_tw_d4,log_rEpl_d4,1);
% Efit_d4 = P_Efit_d4(1)*log_tw_d4 + P_Efit_d4(2);
% antilog_Efit_d4= 10.^(Efit_d4);

% (15,10) CNT
%----------------

% Radius = 13.3 Bohr, mesh-size=0.15, N_c = 5, N_eta = 80, H = 1.6534620499 Bohr

H5 = 1.6534620499/nm2Bohr;
Nc5 = 5;
ndata5 = 26;
rate5 = 0.0004;
tw_d5 = zeros(ndata5,1);
for i = 2:ndata5
    tw_d5(i) = tw_d5(i-1) + (i-1)*rate5 * nm2Bohr; % input is in rad/nm
end

Epl_d5 = [ 
 		   -1.1344566082E+01
 		   -1.1344414203E+01
 		   -1.1343911820E+01
 		   -1.1342680075E+01
 		   -1.1340197127E+01
 		   -1.1335753296E+01
 		   -1.1328593196E+01
 		   -1.1317974615E+01
 		   -1.1303189119E+01
 		   -1.1283709524E+01
 		   -1.1258949303E+01
 		   -1.1229290943E+01
 		   -1.1196050758E+01
 		   -1.1167804326E+01
 		   -1.1147064821E+01
 		   -1.1133388267E+01
 		   -1.1125228369E+01
 		   -1.1124084276E+01
 		   -1.1126438551E+01
 		   -1.1126630134E+01
 		   -1.1122606162E+01
 		   -1.1118264012E+01
 		   -1.1115196661E+01
 		   -1.1114164484E+01
 		   -1.1118111167E+01
 		   -1.1125139132E+01
] * Ha2eV * Nc5/H5; % input is in eV/nm

rEpl_d5 = Epl_d5 - Epl_d5(1);

% (16,0) CNT
%----------------

% Radius = 11.77 Bohr, mesh-size=0.15, N_c = 16, N_eta = 23, H = 4.0023317752 Bohr

H6 = 4.0023317752/nm2Bohr;
Nc6 = 16;
ndata6 = 41;
rate6 = 0.0004;
tw_d6 = zeros(ndata6,1);
for i = 2:ndata6
    tw_d6(i) = tw_d6(i-1) + (i-1)*rate6 * nm2Bohr; % input is in rad/nm
end

Epl_d6 = [ 
 		   -1.1426634931E+01
 		   -1.1426614731E+01
 		   -1.1426451328E+01
 		   -1.1425895652E+01
 		   -1.1424571616E+01
 		   -1.1421982355E+01
 		   -1.1417510726E+01 
 		   -1.1410427734E+01 
 		   -1.1399870225E+01 
 		   -1.1384912061E+01 
 		   -1.1364728099E+01 
 		   -1.1338258233E+01
 		   -1.1304770169E+01
 		   -1.1262948316E+01
 		   -1.1212429616E+01
 		   -1.1154755256E+01
 		   -1.1090314654E+01
 		   -1.1017567553E+01
 		   -1.0940284306E+01
 		   -1.0866635383E+01
 		   -1.0797185593E+01
 		   -1.0698192434E+01
 		   -1.0564950352E+01
 		   -1.0403869010E+01
 		   -1.0232486766E+01
 		   -1.0079969732E+01
 		   -9.9825600495E+00
 		   -9.9718253752E+00
 		   -1.0059918269E+01
 		   -1.0231566989E+01
 		   -1.0447791147E+01
 		   -1.0656877611E+01
 		   -1.0812915506E+01
 		   -1.0925138520E+01
 		   -1.1063688091E+01
 		   -1.1198358088E+01
 		   -1.1314753232E+01
 		   -1.1387715054E+01
 		   -1.1404291810E+01
 		   -1.1357338737E+01
 		   -1.1243470320E+01
] * Ha2eV * Nc6/H6; % input is in eV/nm

rEpl_d6 = Epl_d6 - Epl_d6(1);

% (27,0) CNT
%----------------

% Radius = 19.84 Bohr, mesh-size=0.15, N_c = 27, N_eta = 23, H = 4.0019793139 Bohr

H7 = 4.0019793139/nm2Bohr;
Nc7 = 27;
ndata7 = 26;
rate7 = 0.0004;
tw_d7 = zeros(ndata7,1);
for i = 2:ndata7
    tw_d7(i) = tw_d7(i-1) + (i-1)*rate7 * nm2Bohr; % input is in rad/nm
end

Epl_d7 = [ 
 		   -1.1429003617E+01
 		   -1.1428945290E+01
 		   -1.1428471244E+01
 		   -1.1426863582E+01
 		   -1.1423073215E+01
 		   -1.1415723670E+01
 		   -1.1403019472E+01
 		   -1.1382970700E+01
 		   -1.1353554459E+01
 		   -1.1312772585E+01
 		   -1.1258115348E+01
 		   -1.1189385725E+01
 		   -1.1109112093E+01
 		   -1.1015257343E+01
 		   -1.0913889889E+01
 		   -1.0823461361E+01
 		   -1.0704047494E+01
 		   -1.0527637779E+01
 		   -1.0310597768E+01
 		   -1.0101068447E+01
 		   -9.9734415898E+00
 		   -9.9944201702E+00
 		   -1.0173976076E+01
 		   -1.0448728114E+01
 		   -1.0710775185E+01
 		   -1.0876529873E+01 
] * Ha2eV * Nc7/H7; % input is in eV/nm

rEpl_d7 = Epl_d7 - Epl_d7(1);

% Twist energy Vs twist plot
%------------

figure1 = figure;
box on

hold on
plot(tw_d2,rEpl_d2,'r','Marker','o','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d6,rEpl_d6,'g','Marker','+','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d5,rEpl_d5,'b','Marker','^','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d3,rEpl_d3,'c','Marker','*','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d4,rEpl_d4,'k','Marker','x','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d1,rEpl_d1,'m','Marker','d','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d7,rEpl_d7,'y','Marker','.','Markersize',10,'LineWidth',1,'LineStyle','-')

set(gca,'TickLabelInterpreter','LaTex');
set(gca,'yscale','log','XTick',[0.0 0.8 1.6 2.4 3.2 4.0 4.8],'XMinorTick','on','YTick',[1e-2 1e-1 1e0 1e1 1e2 1e3 1e4],'TickLength',[0.018 0.025],'FontName','Times New Roman','FontSize',16);
%set(gca,'XTickLabel',num2str(get(gca,'XTick')','%.2f'))
%set(gca,'YTickLabel',num2str(get(gca,'YTick')','%.1f'))
%set(gca,'XTickLabel',{'$0.01$', '$0.02$', '$0.04$'});
%set(gca,'YTickLabel',{'$10^{-2}$', '$10^{-1}$', '$10^{0}$'});
xlim([0.0 4.8]);
ylim([1e-2 1e4]);

xlabel('$\alpha$ (rad/nm)','FontSize',16,'FontName','Times New Roman','Interpreter','LaTex');
ylabel('$\mathcal{E}_{twist}$ (eV/nm)','FontSize',16,'FontName','Times New Roman','Interpreter','LaTex');

%ylabel('Relative percentage error (%)','FontSize',16,'FontName','Times New Roman','Interpreter','LaTex');
legend1 = legend('$d = 1.16$ nm','$d = 1.24$ nm','$d = 1.41$ nm','$d = 1.55$ nm','$d = 1.61$ nm','$d = 1.75$ nm','$d = 2.10$ nm','Location','Southeast');
set(legend1,'fontsize',14,'FontName','Times New Roman','Interpreter','LaTex');

%str = 'Slope = 2.0';
%dim = [.2 .58 .3 .3];
%annotation('textbox',dim,'String',str,'FitBoxToText','on');

set(figure1,'Units','Inches');
pos = get(figure1,'Position');
set(figure1,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[1.02*pos(3), 1.02*pos(4)])
saveas(gcf,'twistenergyVstwist','epsc')
hold off
