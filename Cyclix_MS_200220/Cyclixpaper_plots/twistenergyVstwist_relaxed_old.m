close all
clear
clc

nm2Bohr = 18.89726125;
Ha2eV = 27.211386245988;
%===============================================
% Tw_n = Tw_(n-1) + (n-1) * rate ; n = 1,2, ...
%===============================================

% (13,13) CNT
%----------------

% Radius = 16.6 Bohr, mesh-size=0.15, N_c = 13, N_eta = 40, H = 2.309 Bohr

H1 = [2.3119427134;2.3117282116;2.3115344189;2.3138043900;2.3220347991;
	    2.3450584001;2.4326444319;6.6942917068;6.6845490286;6.6753926823;
      6.6637070621]/nm2Bohr;%2.4078234571;2.4274267311;3.9901396451;6.6911629366;6.0403114710

st1 = (H1 - H1(1))/H1(1);

Nc1 = 13;
ndata1 = 11;
rate1 = 0.0004;

% tw_d1 = [2.4166097335E-01;2.4397291607E-01;2.4859637249E-01;2.5553097575E-01;2.6478619331E-01;
%          2.7639636730E-01;2.9046671770E-01;2.9280000000E-01;2.9328548535E-01;2.9400000000E-01;
%          2.9559605586E-01;3.0095148922E-01;3.0898088475E-01;3.1967616319E-01;3.3302694856E-01;
%          3.4901984551E-01]/H1(1);

tw_d1 = [2.4166097335E-01;2.4397291607E-01;2.4859637249E-01;2.5553097575E-01;2.6478619331E-01;
         2.7639636730E-01;2.9328548535E-01;2.9559605586E-01;3.0898088475E-01;3.1967616319E-01;
         3.3302694856E-01]/H1(1);%3.4901984551E-01

tw_d1 = tw_d1 - tw_d1(1);

% Epl_d1 = [-1.1427176972E+01;-1.1426890115E+01;-1.1424996733E+01;-1.1418423056E+01;-1.1402928063E+01
%           -1.1373173091E+01;-1.1324167957E+01;-1.1316221838E+01;-1.1314211330E+01;-1.1394123652E+01;
%           -1.1329546242E+01;-1.1329515104E+01;-1.1329609945E+01;-1.1329606851E+01;-1.1329601043E+01;
%           -1.1329595929E+01] * Ha2eV * Nc1/H1(1);

Epl_d1 = [-1.1427176972E+01;-1.1426890115E+01;-1.1424996733E+01;-1.1418423056E+01;-1.1402928063E+01
          -1.1373173091E+01;-1.1314211330E+01;-1.1329546242E+01;-1.1329609945E+01;-1.1329606851E+01;
          -1.1329601043E+01] * Ha2eV * Nc1/H1(1);%;-1.1329595929E+01

rEpl_d1 = Epl_d1 - Epl_d1(1);

%tw_d1 = tw_d1(2:end);
%rEpl_d1 = rEpl_d1(2:end);

% // log_tw_d1 = log10(tw_d1(1:indx_ln));
% // log_rEpl_d1 = log10(rEpl_d1(1:indx_ln));
% // P_Efit_d1 = polyfit(log_tw_d1,log_rEpl_d1,1);
% // Efit_d1 = P_Efit_d1(1)*log_tw_d1 + P_Efit_d1(2);
% // antilog_Efit_d1= 10.^(Efit_d1);


% (15,0) CNT
%----------------

% Radius = 11 Bohr, mesh-size=0.15, N_c = 15, N_eta = 23, H = 4.0017685908 Bohr

% H2 = [4.0025575528;4.0026377197;4.0030390218;4.0019574415;4.0047944926;
%       4.0120924710;4.0214286075;4.0327895622;4.0360958826;4.0422759189;
%       4.1216723540;4.2193396107;4.3170340781];

H2 = [4.0004801765;4.0021604853;4.0019339329;4.0096457724;4.0250371876;
      4.0571759436;4.1092311414;4.1935376185;4.3245846641;4.7877141374;
      4.8039148134;4.8126587550;4.8118988158;4.7910892013;4.7375579595;
      4.6432650339]/nm2Bohr;

st2 = (H2 - H2(1))/H2(1);


Nc2 = 15;
ndata2 = 16;
rate2 = 0.0004;
% tw_d2 = [2.0943951024E-01;2.1104053326E-01;2.1424264344E-01;2.1904629026E-01;2.2544942217E-01;
%          2.3345901115E-01;2.4308803308E-01;2.5434803319E-01;2.5676768183E-01;2.6161099689E-01;
%          2.9930000000E-01;3.2800000000E-01;3.5331603766E-01];

tw_d2 = [2.0943951024E-01;2.1343999042E-01;2.2144431139E-01;2.3345011319E-01;2.4948869627E-01;
         2.6961388221E-01;2.9395693787E-01;3.2272155586E-01;3.5626985681E-01;3.8070000000E-01;
         3.9507531519E-01;4.0948705963E-01;4.2873769465E-01;4.5279718873E-01;4.8154372394E-01;
         5.1470662966E-01]/H2(1);

tw_d2 = tw_d2 - tw_d2(1);

% Epl_d2 = [-1.1426117239E+01;-1.1426102088E+01;-1.1425965857E+01;-1.1425490548E+01;-1.1424387503E+01;
%           -1.1422228631E+01;-1.1418550454E+01;-1.1412847709E+01;-1.1411422434E+01;-1.1408342827E+01;
%           -1.1375793832E+01;-1.1343511050E+01;-1.1315269772E+01 ] * Ha2eV * Nc2; % input is in eV

Epl_d2 = [-1.1426308200E+01;-1.1426293477E+01;-1.1425384089E+01;-1.1422775763E+01;-1.1416249751E+01;
          -1.1402885306E+01;-1.1381126376E+01;-1.1348996352E+01;-1.1311377300E+01;-1.1342602346E+01;
          -1.1342408824E+01;-1.1341970807E+01;-1.1341532137E+01;-1.1341082429E+01;-1.1341046872E+01;
          -1.1339879750E+01] * Ha2eV * Nc2/H2(1); % input is in eV

rEpl_d2 = Epl_d2 - Epl_d2(1);

%tw_d2 = tw_d2(2:end);
%rEpl_d2 = rEpl_d2(2:end);`

% log_tw_d2 = log10(tw_d2(1:indx_ln));
% log_rEpl_d2 = log10(rEpl_d2(1:indx_ln));
% P_Efit_d2 = polyfit(log_tw_d2,log_rEpl_d2,1);
% Efit_d2 = P_Efit_d2(1)*log_tw_d2 + P_Efit_d2(2);
% antilog_Efit_d2= 10.^(Efit_d2);

% (20,0) CNT
%----------------

% Radius = 14.7 Bohr, mesh-size=0.15, N_c = 20, N_eta = 23, H = 4.0002688791 Bohr

% H3 = [4.0008524928;4.0020115438;4.0024672877;4.0042378665;4.0079652387;
%       4.0166842292;4.0326420057;4.0350928138;4.0452067105;4.0631468985;
%       4.0719085424;4.0903232239;4.1216223445;4.1734821142;4.2667826876];

H3 = [4.0012167388;4.0041327102;4.0052192297;4.0171064298;4.0458919850;
      4.0999485806;4.1912515399;4.3394605718;4.7992594608;
      4.8141589261;4.7907154408]/nm2Bohr;%4.8144417593;4.7306486923;4.3005904815;4.0592992482;
      %4.0095147798;4.0150967621;4.0895161134;4.2682386954];

st3 = (H3 - H3(1))/H3(1);

Nc3 = 20;
ndata3 = 11;
rate3 = 0.0004;
% tw_d3 = [1.5707963268E-01;1.5867997368E-01;1.6188158291E-01;1.6668454366E-01;1.7309132424E-01;
%          1.8110725472E-01;1.9074729687E-01;1.9316562440E-01;1.9800773578E-01;2.0528910786E-01;
%          2.0853961363E-01;2.1505466730E-01;2.2487144304E-01;2.3806063454E-01;2.5475456300E-01];

tw_d3 = [1.5707963268E-01;1.6108084942E-01;1.6908911484E-01;1.8110477253E-01;1.9717319825E-01;
         2.1740265817E-01;2.4200234966E-01;2.7134111043E-01;2.9250000000E-01;
         3.2135452329E-01;3.4061115900E-01]/H3(1);%3.0691119801E-01;3.6456473620E-01;3.9294862835E-01;4.2305276172E-01;
         %4.5552715571E-01;4.9161278873E-01;5.3176375635E-01;5.7674843360E-01];

tw_d3 = tw_d3 - tw_d3(1);

% Epl_d3 = [-1.1427967901E+01;-1.1427932003E+01;-1.1427685393E+01;-1.1426846006E+01;-1.1424887991E+01;
%           -1.1421112710E+01;-1.1414654187E+01;-1.1412742358E+01;-1.1408514882E+01;-1.1401250047E+01;
%           -1.1397680928E+01;-1.1389967954E+01;-1.1377019898E+01;-1.1357503039E+01;-1.1331812574E+01;] * Ha2eV * Nc3; % input is in eV

Epl_d3 = [-1.1428230105E+01;-1.1427982287E+01;-1.1426664086E+01;-1.1421666510E+01;-1.1409077993E+01;
          -1.1386609883E+01;-1.1351168068E+01;-1.1307087178E+01;-1.1343200734E+01;
          -1.1342775195E+01;-1.1342154692E+01] * Ha2eV * Nc3/H3(1);%-1.1343102369E+01;-1.1340528816E+01;-1.1310971387E+01;-1.1399559785E+01;
          %-1.1422605106E+01;-1.1419138512E+01;-1.1382655748E+01;-1.1312498523E+01] * Ha2eV * Nc3;

rEpl_d3 = Epl_d3 - Epl_d3(1);

% tw_d3 = tw_d3(2:end);
% rEpl_d3 = rEpl_d3(2:end);

% log_tw_d3 = log10(tw_d3(1:indx_ln));
% log_rEpl_d3 = log10(rEpl_d3(1:indx_ln));
% P_Efit_d3 = polyfit(log_tw_d3,log_rEpl_d3,1);
% Efit_d3 = P_Efit_d3(1)*log_tw_d3 + P_Efit_d3(2);
% antilog_Efit_d3= 10.^(Efit_d3);

% (16,0) CNT
%----------------

% Radius = 11.77 Bohr, mesh-size=0.15, N_c = 16, N_eta = 23, H = 4.0007020478 Bohr

% H4 = [4.0007020478;4.0005692146;4.0006545146;4.0018366644;4.0045787040;4.0115659096;4.0136650843
% 	  4.0185023304;4.0273977418;4.0408006054;4.0631590108;4.0964076875;4.1462177019;4.2237813342
% 	  4.3168662081];

H4 = [4.0025378031;4.0021760330;4.0048033494;4.0106439618;4.0275943849;
      4.0617133146;4.1223652478;4.2253852808;4.3534365495;4.8072168842;
      4.8137954585;4.8129939507]/nm2Bohr;%4.7975323853;4.7543929725;4.6790377282;
      %4.2536712093;4.0461124757;4.0091309625;4.0149641697;4.0836101616;
      %4.2311384416;4.5062085650;4.7682406527;];

st4 = (H4 - H4(1))/H4(1);


Nc4 = 16;
ndata4 = 12;
% tw_d4 = [1.9634954085E-01;1.9794982167E-01;2.0115030980E-01;2.0595109521E-01;2.1235403388E-01;
% 		 2.2036319128E-01;2.2277013083E-01;2.2758652893E-01;2.3481983312E-01;2.4448558770E-01;
% 		 2.5660798952E-01;2.7123536196E-01;2.8844027424E-01;3.0834211921E-01;3.3115053842E-01];

tw_d4 = [1.9634954085E-01;2.0035207865E-01;2.0835643072E-01;2.2037084077E-01;2.3641341661E-01;
         2.5655138854E-01;2.8092166843E-01;3.0977822516E-01;3.4358130741E-01;3.7260000000E-01;
         3.8702688204E-01;4.0146826841E-01]/H4(1);%4.2072024422E-01;4.4470790614E-01;4.7323426398E-01;
         %5.0598752808E-01;5.4001689775E-01;5.7643191003E-01;6.1652321966E-01;6.6068782552E-01;
         %7.0969114746E-01;7.6469594720E-01;8.2778286711E-01];

tw_d4 = tw_d4 - tw_d4(1);

% Epl_d4 = [-1.1426616595E+01;-1.1426595200E+01;-1.1426436182E+01;-1.1425915805E+01;-1.1424676448E+01;
% 		  -1.1422270046E+01;-1.1421352941E+01;-1.1419261470E+01;-1.1415490536E+01;-1.1409345615E+01;
% 		  -1.1399906524E+01;-1.1386217925E+01;-1.1367332751E+01;-1.1342937500E+01;-1.1315703646E+01] * Ha2eV * Nc4; % input is in eV

Epl_d4 = [-1.1426852366E+01;-1.1426734008E+01;-1.1425881254E+01;-1.1422753850E+01;-1.1415247457E+01;
          -1.1400051273E+01;-1.1375755169E+01;-1.1340432724E+01;-1.1300879307E+01;-1.1342577063E+01;
          -1.1342765225E+01;-1.1342480241E+01]* Ha2eV * Nc4/H4(1);%-1.1341842899E+01;-1.1340755767E+01;-1.1340188386E+01;
          %-1.1306854313E+01;-1.1407294827E+01;-1.1422642802E+01;-1.1417383172E+01;-1.1385293677E+01;
          %-1.1325377545E+01;-1.1297205557E+01;-1.1303810967E+01] * Ha2eV * Nc4; % input is in eV


rEpl_d4 = Epl_d4 - Epl_d4(1);


% (27,0) CNT
%----------------

% Radius = 19.84 Bohr, mesh-size=0.15, N_c = 27, N_eta = 23, H = 4.0025688504 Bohr

% H5 = [4.0025688504;4.0002588954;4.0012787199;4.0058327038;4.0082919074
% 	  4.0148424547;4.0260270315;4.0441037754;4.0785923021;4.1303327386
% 	  4.2206156482;4.3343673008;4.8151980076;4.8061655233;4.7139246723];

% H5 = [4.0040377657;4.0010628972;4.0029653223;4.0067085645;4.0067863515;
%       4.0147786388;4.0249080164;4.0490129433;4.0803484579;4.1133436149;
%       4.2701748748;4.3496045698;4.8030288684;4.7930489854;4.6871574636];

H5 = [3.9971363152;3.9981636789;4.0039773541;4.0294433303;4.0775632412;
      4.1749011947;4.3496045698;4.7958390581;4.8018196892]/nm2Bohr;%;4.7478510984

st5 = (H5 - H5(1))/H5(1);

Nc5 = 27;
ndata5 = 9;
 % tw_d5 = [1.1635528347E-01;1.1795631101E-01;1.2115651812E-01;1.2595805259E-01;1.2796096894E-01
 %          1.3196926085E-01;1.3799152453E-01;1.4604357859E-01;1.5615383803E-01;1.6838961494E-01
 %          1.8284577952E-01;1.9972824212E-01;2.3000000000E-01;2.4444559402E-01;2.7328258716E-01];

% tw_d5 = [1.1635528347E-01;1.1795631101E-01;1.2115651812E-01;1.2596308770E-01;1.2756577112E-01;
% 		 1.3237667300E-01;1.3719868186E-01;1.4688165219E-01;1.5662747487E-01;1.6481290845E-01;
% 		 1.8988641331E-01;2.0275574747E-01;2.2080000000E-01;2.4965009696E-01;2.7840839087E-01];

tw_d5 = [1.1635528347E-01;1.2035241978E-01;1.2834874714E-01;1.4036067920E-01;1.5647845252E-01;
         1.7686626873E-01;2.0275574747E-01;2.1600000000E-01;2.4483512400E-01]/H5(1);%2.6404240276E-01

tw_d5 = tw_d5 - tw_d5(1);


 % Epl_d5 = [-1.1428979349E+01;-1.1428944579E+01;-1.1428500636E+01;-1.1427000129E+01;-1.1426068586E+01
 % 		  -1.1423709518E+01;-1.1418951876E+01;-1.1410326096E+01;-1.1396074717E+01;-1.1374557681E+01
 % 		  -1.1344699383E+01;-1.1310471854E+01;-1.1344135057E+01;-1.1344348910E+01;-1.1343976029E+01] * Ha2eV * Nc5; % input is in eV

% Epl_d5 = [-1.1428672315E+01;-1.1429328320E+01;-1.1428610237E+01;-1.1426914399E+01;-1.1426606925E+01;
%           -1.1423420160E+01;-1.1419371657E+01;-1.1409041295E+01;-1.1395761414E+01;-1.1381749108E+01;
%           -1.1330574325E+01;-1.1342279169E+01;-1.1341629657E+01;-1.1338771921E+01 ] * Ha2eV * Nc5;

Epl_d5 = [-1.1428923606E+01;-1.1428696172E+01;-1.1425888749E+01;-1.1417153344E+01;-1.1395404125E+01;
          -1.1357593408E+01;-1.1304571139E+01;-1.1342271743E+01;-1.1341918103E+01] * Ha2eV * Nc5/H5(1);%;-1.1340469444E+01


rEpl_d5 = Epl_d5 - Epl_d5(1);


% (22,11) CNT
%-------------

% Radius = 21.4 Bohr, mesh-size=0.15, N_c = 11, N_eta = 30, H = 1.51 Bohr

H6 = [1.5126578089;1.5135486044;1.5142433437;1.5190317595;1.5269342990;
      1.5447107011;1.5814435162;1.6555675223;2.8504144190;
      2.7655577489;2.8220057724]/nm2Bohr;%2.8405337723;2.7739433486;;2.3155093119

st6 = (H6 - H6(1))/H6(1);

Nc6 = 11;
ndata6 = 11;

tw_d6 = [2.0399952296E-01;2.0490711765E-01;2.0672337597E-01;2.0944901399E-01;2.1309469021E-01;
         2.1767549311E-01;2.2323645163E-01;2.2987851440E-01;2.3400000000E-01;
         2.4074132480E-01;2.4516621720E-01]/H6(1);%2.3514016577E-01;2.3741259279E-01;2.5081022875E-01

tw_d6 = tw_d6 - tw_d6(1);

Epl_d6 = [-1.1426120330E+01;-1.1426161804E+01;-1.1424639034E+01;-1.1420855237E+01;-1.1411354056E+01;
          -1.1393051105E+01;-1.1362090644E+01;-1.1315844367E+01;-1.1344022252E+01;
          -1.1341410734E+01;-1.1340677155E+01]  * Ha2eV * Nc6/H6(1);%-1.1343811419E+01;-1.1342996031E+01;-1.1371161303E+01

rEpl_d6 = Epl_d6 - Epl_d6(1);


%   GGA
%=========

H6_GGA = [1.5179850400;1.5094432494;1.5157611752;1.5267957423;1.5310197315;
          1.5723385764;1.6429786638;3.0584975316;2.9861969035;2.9717253425]/nm2Bohr;

st6_GGA = (H6_GGA - H6_GGA(1))/H6_GGA(1);

Nc6_GGA = 11;
ndata6_GGA = 10;

tw_d6_GGA = [2.0399952296E-01;2.0490711765E-01;2.0944901399E-01;2.1309469021E-01;2.1767549311E-01;
             2.2323645163E-01;2.2987851440E-01;2.3400000000E-01;2.4074132480E-01;2.4516621720E-01]/H6_GGA(1);

tw_d6_GGA = tw_d6_GGA - tw_d6_GGA(1);

Epl_d6_GGA = [-1.1401774592E+01;-1.1400875951E+01;-1.1396486040E+01;-1.1387080511E+01;-1.1367894605E+01;
              -1.1337582422E+01;-1.1293471477E+01;-1.1327316285E+01;-1.1325214592E+01;-1.1322861901E+01]  * Ha2eV * Nc6_GGA/H6_GGA(1);

rEpl_d6_GGA = Epl_d6_GGA - Epl_d6_GGA(1);


% (18,9) CNT
%-----------

% Radius = 17.46 Bohr, mesh-size=0.15, N_c = 9, N_eta = 30, H = 1.51 Bohr

H7 = [1.5134838822;1.5136466972;1.5141798266;1.5161916019;1.5212097640;
      1.5323425658;1.5547457030;1.5988738992;1.6838621551;3.1534969490;
      2.9411252626;3.0800673079]/nm2Bohr;%2.3784417332;

st7 = (H7 - H7(1))/H7(1);

Nc7 = 9;
ndata7 = 12;

tw_d7 = [2.4933275028E-01;2.5024084061E-01;2.5205721665E-01;2.5478274034E-01;2.5842160018E-01;
         2.6298522948E-01;2.6850166271E-01;2.7503159466E-01;2.8270618938E-01;2.8800000000E-01;
         2.9116415217E-01; 2.9469350248E-01]/H7(1);%2.8926139878E-01;

tw_d7 = tw_d7 - tw_d7(1);

Epl_d7 = [-1.1425731436E+01;-1.1425578964E+01;-1.1424706362E+01;-1.1421878853E+01;-1.1415447033E+01;
          -1.1403079093E+01;-1.1382023084E+01;-1.1348878624E+01;-1.1305733761E+01;-1.1343591165E+01;
          -1.1343051446E+01;-1.1342564995E+01]  * Ha2eV * Nc7/H7(1);%-1.1348559180E+01;

rEpl_d7 = Epl_d7 - Epl_d7(1);

% Twist energy Vs twist plot
%------------

figure1 = figure;
box on

hold on
%plot(tw_d2,rEpl_d2,'Marker','o','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d4,rEpl_d4,'color',[0 0 1],'Marker','x','Markersize',12,'LineWidth',1,'LineStyle','-')
plot(tw_d3,rEpl_d3,'color',[1 0 0],'Marker','*','Markersize',12,'LineWidth',1,'LineStyle','-')
plot(tw_d1,rEpl_d1,'color',[0 0.6 0],'Marker','d','Markersize',12,'LineWidth',1,'LineStyle','-')
plot(tw_d7,rEpl_d7,'color',[0.95 0.00 0.75],'Marker','+','Markersize',12,'LineWidth',1,'LineStyle','-')
plot(tw_d5,rEpl_d5,'color',[0.64 0.08 0.18],'Marker','sq','Markersize',12,'LineWidth',1,'LineStyle','-')
plot(tw_d6,rEpl_d6,'color',[0.99 0.60 0.13],'Marker','^','Markersize',12,'LineWidth',1,'LineStyle','-')


set(gca,'TickLabelInterpreter','LaTex');
set(gca,'yscale','log','XTick',[0.00 0.25 0.50 0.75 1.00],'XMinorTick','on','YTick',[1e-1 1e0 1e1 1e2 1e3],'TickLength',[0.018 0.025],'FontName','Times New Roman','FontSize',16);
%set(gca,'XTickLabel',num2str(get(gca,'XTick')','%.2f'))
%set(gca,'YTickLabel',num2str(get(gca,'YTick')','%.1f'))
%set(gca,'XTickLabel',{'$0.01$', '$0.02$', '$0.04$'});
%set(gca,'YTickLabel',{'$10^{-2}$', '$10^{-1}$', '$10^{0}$'});
xlim([0.00 1.0]);
ylim([1e-1 1e3]);

xlabel('Twist (rad/nm)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');
ylabel('$\mathcal{E}_{twist}$ (eV/nm)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');

%legend1 = legend('$d_t = 1.25$ nm','$d_t = 1.56$ nm','$d_t = 1.75$ nm','$d_t = 1.85$ nm','$d_t = 2.10$ nm','$d_t = 2.26$ nm','Location','Southeast');
legend1 = legend('$(16,0)$','$(20,0)$','$(13,13)$','$(18,9)$','$(27,0)$','$(22,11)$','Location','Southeast');

set(legend1,'fontsize',20,'FontName','Times New Roman','Interpreter','LaTex');

%str = 'Slope = 2.0';
%dim = [.2 .58 .3 .3];
%annotation('textbox',dim,'String',str,'FitBoxToText','on');

% set(figure1,'Units','Inches');
% pos = get(figure1,'Position');
% set(figure1,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[1.02*pos(3), 1.02*pos(4)])
% saveas(gcf,'twistenergyVstwist_relaxed','epsc')
% hold off

figure1_inset = twistenergyVstwist_linear_relaxed;

fig3=inset(figure1,figure1_inset);
 saveas(gca,'twistplot','epsc')

% Strain with twist
% figure2 = figure;
% box on

% hold on
% %plot(tw_d2,st2,'Marker','o','Markersize',10,'LineWidth',1,'LineStyle','-')
% plot(tw_d4,st4,'color',[0 0 1],'Marker','x','Markersize',12,'LineWidth',1,'LineStyle','-')
% plot(tw_d3,st3,'color',[1 0 0],'Marker','*','Markersize',12,'LineWidth',1,'LineStyle','-')
% plot(tw_d1,st1,'color',[0 0.6 0],'Marker','d','Markersize',12,'LineWidth',1,'LineStyle','-')
% plot(tw_d7,st7,'color',[0.95, 0, 0.75],'Marker','+','Markersize',12,'LineWidth',1,'LineStyle','-')
% plot(tw_d5,st5,'color',[0.64, 0.08, 0.18],'Marker','sq','Markersize',12,'LineWidth',1,'LineStyle','-')
% plot(tw_d6,st6,'color',[0.99, 0.60, 0.13],'Marker','^','Markersize',12,'LineWidth',1,'LineStyle','-')

% set(gca,'TickLabelInterpreter','LaTex');
% set(gca,'yscale','log','YTick',[1e-4 1e-3 1e-2 1e-1 1e0],'XTick',[0.00 0.25 0.50 0.75 1.00],'XMinorTick','on','TickLength',[0.018 0.025],'FontName','Times New Roman','FontSize',16);
% %set(gca,'XTickLabel',num2str(get(gca,'XTick')','%.2f'))
% %set(gca,'YTickLabel',num2str(get(gca,'YTick')','%.1f'))
% %set(gca,'XTickLabel',{'$0.01$', '$0.02$', '$0.04$'});
% %set(gca,'YTickLabel',{'$10^{-2}$', '$10^{-1}$', '$10^{0}$'});

% ylim([1e-4 3]);
% xlim([0.00 1.0]);

% ylabel('Strain','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');
% xlabel('Twist (rad/nm)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');

% %legend2 = legend('$d_t = 1.25$ nm','$d_t = 1.56$ nm','$d_t = 1.75$ nm','$d_t = 1.85$ nm','$d_t = 2.10$ nm','$d_t = 2.26$ nm','Location','Southeast');
% legend2 = legend('$(16,0)$','$(20,0)$','$(13,13)$','$(18,9)$','$(27,0)$','$(22,11)$','Location','Southeast');
% set(legend2,'fontsize',20,'FontName','Times New Roman','Interpreter','LaTex');

% %str = 'Slope = 2.0';
% %dim = [.2 .58 .3 .3];
% %annotation('textbox',dim,'String',str,'FitBoxToText','on');

% set(figure2,'Units','Inches');
% pos = get(figure2,'Position');
% set(figure2,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[4,2])
% saveas(gcf,'strainVstwist_relaxed','epsc')
% hold off


% %%% With and without relaxation
% % (27,0) CNT (w/o relaxation)
% %----------------

% H5_nr = 4.0019793139/nm2Bohr;
% Nc5_nr = 27;
% ndata5_nr = 26;
% rate5_nr = 0.0004;
% tw_d5_nr = zeros(ndata5_nr,1);
% for i = 2:ndata5_nr
%     tw_d5_nr(i) = tw_d5_nr(i-1) + (i-1)*rate5_nr * nm2Bohr; % input is in rad/nm
% end

% Epl_d5_nr = [ 
%        -1.1429003617E+01
%        -1.1428945290E+01
%        -1.1428471244E+01
%        -1.1426863582E+01
%        -1.1423073215E+01
%        -1.1415723670E+01
%        -1.1403019472E+01
%        -1.1382970700E+01
%        -1.1353554459E+01
%        -1.1312772585E+01
%        -1.1258115348E+01
%        -1.1189385725E+01
%        -1.1109112093E+01
%        -1.1015257343E+01
%        -1.0913889889E+01
%        -1.0823461361E+01
%        -1.0704047494E+01
%        -1.0527637779E+01
%        -1.0310597768E+01
%        -1.0101068447E+01
%        -9.9734415898E+00
%        -9.9944201702E+00
%        -1.0173976076E+01
%        -1.0448728114E+01
%        -1.0710775185E+01
%        -1.0876529873E+01 
% ] * Ha2eV * Nc5_nr/H5_nr; % input is in eV/nm

% rEpl_d5_nr = Epl_d5_nr - Epl_d5_nr(1);

% figure3 = figure;
% box on

% hold on
% plot(tw_d5,rEpl_d5,'color',[1 0 0],'Marker','sq','Markersize',12,'LineWidth',1,'LineStyle','-')
% plot(tw_d5_nr,rEpl_d5_nr,'color',[0 0 1],'Marker','d','Markersize',12,'LineWidth',1,'LineStyle','-')


% set(gca,'TickLabelInterpreter','LaTex');
% set(gca,'yscale','log','XTick',[0.00 0.50 1.00 1.50 2.00 2.50],'XMinorTick','on','YTick',[1e-1 1e0 1e1 1e2 1e3],'TickLength',[0.018 0.025],'FontName','Times New Roman','FontSize',16);
% set(gca,'XTickLabel',num2str(get(gca,'XTick')','%.2f'))
% %set(gca,'YTickLabel',num2str(get(gca,'YTick')','%.1f'))
% %set(gca,'XTickLabel',{'$0.01$', '$0.02$', '$0.04$'});
% %set(gca,'YTickLabel',{'$10^{-2}$', '$10^{-1}$', '$10^{0}$'});
% xlim([0.00 2.50]);
% ylim([1e-1 6e3]);

% xlabel('Twist (rad/nm)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');
% ylabel('$\mathcal{E}_{twist}$ (eV/nm)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');

% %legend1 = legend('$d_t = 1.25$ nm','$d_t = 1.56$ nm','$d_t = 1.75$ nm','$d_t = 1.85$ nm','$d_t = 2.10$ nm','$d_t = 2.26$ nm','Location','Southeast');
% legend3 = legend('relaxed','unrelaxed','Location','Southeast');

% set(legend3,'fontsize',20,'FontName','Times New Roman','Interpreter','LaTex');

% %str = 'Slope = 2.0';
% %dim = [.2 .58 .3 .3];
% %annotation('textbox',dim,'String',str,'FitBoxToText','on');

% set(figure3,'Units','Inches');
% pos = get(figure3,'Position');
% set(figure3,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[4,2])
% saveas(gcf,'twistenergyVstwist_comparison','epsc')
% hold off