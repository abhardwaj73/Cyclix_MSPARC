close all
clear
clc

nm2Bohr = 18.89726125;
Ha2eV = 27.211386245988;
%===============================================
% Tw_n = Tw_(n-1) + (n-1) * rate ; n = 1,2, ...
%===============================================

% (13,13) CNT
%----------------

% Radius = 16.6 Bohr, mesh-size=0.3, N_c = 13, N_eta = 40, H = 2.309 Bohr
H1 = [2.3095883971]/nm2Bohr;

Nc1 = 13;
ndata1 = 22;

tw_d1 = [2.4166097335E-01; 2.4258525219E-01;2.4350893866E-01;2.4443309635E-01;2.4535720473E-01;
         2.4628142786E-01;2.4859637249E-01;2.4975196922E-01;2.5206317343E-01;2.5553097575E-01;
         2.5668767554E-01;2.5900174059E-01;2.6247540102E-01;2.6478619331E-01;2.6594713960E-01;
         2.6827077114E-01;2.7176170465E-01;2.7639636730E-01;2.7756887363E-01;2.7991735886E-01;
         2.8345199407E-01;2.9046671770E-01;]/H1(1);%2.9167229519E-01;2.9280000000E-01  2.4166097335E-01;2.4397291607E-01;2.4512871480E-01;

tw_d1 = tw_d1 - tw_d1(1);

bg_d1 = [0.0001855929;0.0025793338;0.0050977869;0.0075473631;0.0099754528;
         0.0125705660;0.0186290056;0.0217004780;0.0278489476;0.0085016451;
         0.0054969218;0.0009052553;0.0101269899;0.0160996185;0.0191158184;
         0.0176670166;0.0091967572;0.0030329732;0.0048955605;0.0227394620;
         0.0139979766;0.0011583025;] * Ha2eV;%0.0166085348;0.0135429531  0.0062183369;0.0093165212;

me_d1 = [0;0.0215;0.0321;0.0647;0.0779;0.1017;0.0285;0.0186;0.0037;0.0376;0.0625;0.0768;0.0556];

mh_d1 = -[0;0.0215;0.0318;0.0663;0.07568;0.0978;0.0282;0.0185;0.0037;0.0370;0.06079;0.0740;0.0568];       

kpt_homo = [0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;
            0.000000 0.333333;0.923077 0.283333;0.923077 0.283333;0.923077 0.283333;0.076923 -0.316667;
            0.076923 -0.316667;0.076923 -0.316667;0.076923 -0.316667;0.153846 -0.266667;0.153846 -0.266667;
            0.153846 -0.266667;0.153846 -0.266667;0.153846 -0.266667;0.230769 -0.216667;0.230769 -0.216667;
            0.230769 -0.216667];

kpt_lumo = [0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;
            0.000000 0.333333;0.000000 0.333333;0.000000 0.333333;0.923077 0.283333;0.076923 -0.316667;
            0.076923 -0.316667;0.076923 -0.316667;0.076923 -0.316667;0.076923 -0.316667;0.153846 -0.266667;
            0.153846 -0.266667;0.153846 -0.266667;0.153846 -0.266667;0.846154 0.283333;0.846154 0.283333;
            0.230769 -0.216667];

% (20,0) CNT
%----------------

% Radius = 14.7 Bohr, mesh-size=0.3, N_c = 20, N_eta = 23, H = 4.0002688791 Bohr

H2 = [3.9999980208]/nm2Bohr;

Nc2 = 20;
ndata2 = 20;

tw_d2 = [1.5707963268E-01;1.5867974107E-01;1.6027993216E-01;1.6348050953E-01;1.6508109060E-01;
         1.6908911484E-01;1.7109155663E-01;1.7509777500E-01;1.8110477253E-01;1.8311329764E-01;
         1.8713272246E-01;1.9316994823E-01;1.9717319825E-01;1.9919459538E-01;2.0324173615E-01;
         2.0932763406E-01;2.1740265817E-01;2.1945184443E-01;2.2355647425E-01;2.2973339499E-01;]/H2(1);%2.4200234966E-01;2.4409812160E-01; 1.6708585683E-01;1.6188023681E-01;1.6108084942E-01;1.6308237428E-01;

tw_d2 = tw_d2 - tw_d2(1);


bg_d2 = [0.0177922114;0.0183717523;0.0181456737;0.0177679752;0.0176048954;
         0.0167306772;0.0162318084;0.0150476429;0.0114544653;0.0106915527;
         0.0084191268;0.0044365513;0.0008243739;0.0004442174;0.0038520734;
         0.0101603088;0.0245961758;0.0251846626;0.0196896814;0.0121310748] * Ha2eV;%;0.0091568791;0.0125268302 0.0164409353;0.0171327177;0.0190978978;0.0169532160

kpt_homo = [0.350000 -0.325000;0.350000 -0.320000;0.350000 -0.308000;0.350000 -0.294000;0.350000 -0.278000;0.400000 -0.193583;0.400000 -0.174000];

kpt_lumo = [0.350000 -0.325000;0.350000 -0.320000;0.350000 -0.310000;0.350000 -0.296000;0.350000 -0.278000;0.350000 -0.256000;0.500000 0.001167];

% (16,0) CNT
%----------------

% Radius = 11.77 Bohr, mesh-size=0.3, N_c = 16, N_eta = 23, H = 4.0007020478 Bohr

H3 = [4.0009279109]/nm2Bohr;

Nc3 = 16;
ndata3 = 19;
tw_d3 = [1.9634954085E-01;1.9955133873E-01;2.0275347201E-01;2.0835643072E-01;2.1035878003E-01;
         2.1436424064E-01;2.2237634281E-01;2.2638887772E-01;2.3641341661E-01;2.3842736415E-01;
         2.4245779955E-01;2.4851177672E-01;2.5655138854E-01;2.5858173984E-01;2.6264652848E-01;
         2.6875634020E-01;2.8092166843E-01;2.8298298715E-01;2.8711141209E-01]/H3(1); %2.0035207865E-01;2.0235292756E-01 2.2037084077E-01; 1.9795047356E-01;2.0115242157E-01;2.0435463346E-01;

tw_d3 = tw_d3 - tw_d3(1);


bg_d3 = [0.0205869485;0.0207437207;0.0207721590;0.0209827435;0.0210570230;
         0.0217296428;0.0239029266;0.0247209948;0.0332286149;0.0320802468;
         0.0296229470;0.0247455996;0.0182530984;0.0173080665;0.0137763745;
         0.0074349178;0.0054169302;0.0069188358;0.0112674928;] * Ha2eV; % input is in eV 0.0196613644;0.0199420388; 0.0239220207; 0.0204728694;0.0206586890;0.0208740889;

kpt_homo = [0.312500 -0.343000;0.312500 -0.341000;0.312500 -0.333333;0.312500 -0.324000;0.625000 0.262417;
            0.375000 -0.242000;0.625000 0.220000];

kpt_lumo = [0.312500 -0.343000;0.312500 -0.341000;0.312500 -0.333333;0.312500 -0.326000;0.312500 -0.310000;
            0.375000 -0.246000;0.625000 0.220000];

% (27,0) CNT
%----------------

% Radius = 19.84 Bohr, mesh-size=0.3, N_c = 27, N_eta = 23, H = 4.0025688504 Bohr

H4 = [4.0009179631]/nm2Bohr;

Nc4 = 27;
ndata4 = 18;

tw_d4 = [1.1635528347E-01;1.1955773183E-01;1.2035241978E-01;1.2235392043E-01;1.2635773064E-01;
         1.2834874714E-01;1.3035365326E-01;1.3436573243E-01;1.4036067920E-01;1.4237433968E-01;
         1.4640616419E-01;1.5246922574E-01;1.5647845252E-01;1.5851678719E-01;1.6260121166E-01;
         1.6875485897E-01;1.7686626873E-01;1.7895316195E-01;]/H4(1);%1.8314101944E-01;

tw_d4 = tw_d4 - tw_d4(1);

bg_d4 = [0.0009087744;0.0012836314;0.0012166369;0.0011292176;0.0021234078;
         0.0034687975;0.0041883606;0.0063445818;0.0097294351;0.0127816883;
         0.0155966866;0.0132435650;0.0080019510;0.0049642770;0.0016495149;
         0.0126929409;0.0029378242;0.0018712449;] * Ha2eV;%0.0109370530

kpt_homo = [0.333333 -0.333333;0.333333 -0.333333;0.333333 -0.316000;0.333333 -0.296000;0.370370 -0.240000;
            0.592593 0.168000];

kpt_lumo = [0.333333 -0.333333;0.333333 -0.333333;0.333333 -0.316000;0.333333 -0.296000;0.370370 -0.240000;
            0.592593 0.168000];

% (22,11) CNT
%-------------

% Radius = 21.4 Bohr, mesh-size=0.3, N_c = 11, N_eta = 30, H = 1.51 Bohr

H5 = [1.5126400197]/nm2Bohr;

Nc5 = 11;
ndata5 = 18;

tw_d5 = [2.0399952296E-01;2.0460451945E-01;2.0520955054E-01;2.0581497183E-01;2.0642016346E-01;
         2.0702566820E-01;2.0748026143E-01;2.0899438775E-01;2.0944901399E-01;2.1020652715E-01;
         2.1172253688E-01;2.1309469021E-01;2.1538123477E-01;2.1767549311E-01;2.1844519508E-01;
         2.1998861680E-01;2.2231741249E-01;2.2402617734E-01]/H5(1); %2.0490711765E-01;2.0566365359E-01;2.0672337597E-01;;2.2561234863E-01

tw_d5 = tw_d5 - tw_d5(1);

bg_d5 = [0.0118583766;0.0144859116;0.0164725983;0.0144009442;0.0115158506;
         0.0090462582;0.0088081063;0.0047053926;0.0022479998;0.0010981617;
         0.0045989746;0.0061016423;0.0122698672;0.0174021039;0.0135933215;
         0.0122110323;0.0101663413;0.0069791900] * Ha2eV;       %0.0163918127;0.0162907569;0.0161349747;;0.007601999

kpt_homo = [0.363636 0.345000;0.363636 0.346333;0.272727 0.314667;0.272727 0.316667;0.272727 0.322667;
            0.363636 0.374133;0.363636 0.429200];

kpt_lumo = [0.363636 0.345000;0.363636 0.346333;0.272727 0.316667;0.272727 0.316667;0.272727 0.322667;
            0.363636 0.369217;0.454545 0.437067];

% (18,9) CNT
%-----------

% Radius = 17.46 Bohr, mesh-size=0.3, N_c = 9, N_eta = 30, H = 1.51 Bohr

H6 = [1.5119846187]/nm2Bohr;

Nc6 = 9;
ndata6 = 24;

tw_d6 = [2.4933275028E-01;2.4993795963E-01;2.5054291064E-01;2.5114786009E-01;2.5175292042E-01;
         2.5205721665E-01;2.5281415238E-01;2.5432826203E-01;2.5554042055E-01;
         2.5705642560E-01;2.5842160018E-01;2.5918163688E-01;2.6070293042E-01;2.6298522948E-01;
         2.6375043228E-01;2.6528305966E-01;2.6758942451E-01;2.6850166271E-01;2.7083382340E-01;
         2.7318125042E-01;2.7503189E-01;2.7582903300E-01;2.7743044938E-01]/H6(1);%2.6927766352E-01; 2.5024084061E-01;2.5099772575E-01; 2.5478274034E-01;

tw_d6 = tw_d6 - tw_d6(1);

bg_d6 = [0.0007736012;0.0020306156;0.0043571108;0.0063898496;0.0089721109;
         0.0096388624;0.0127181498;0.0177080359;0.0214535597;
         0.0173345758;0.0140517305;0.0120696112;0.0102259859;0.0038896642;
         0.0023173967;0.0001998377;0.0035848340;0.0046380134;0.0061044191;
         0.0078291126;0.0053029912;0.0048539262;0.0030392333 ] * Ha2eV;     %0.0033512880;  0.0032725395;0.0062676094;  0.0225149893;  

kpt_homo = [0.333333 0.333333;0.333333 0.333333;0.333333 0.337000;0.333333 0.339667;0.222222 0.300000;
            0.222222 0.305333;0.000000 -0.216850;0.111111 0.265967];

kpt_lumo = [0.333333 0.333333;0.333333 0.333333;0.333333 0.337000;0.333333 0.339667;0.222222 0.300000;
            0.222222 0.305333;0.000000 -0.217833;0.222222 0.312183];

% Band gap Vs twist plot
%------------

figure1 = figure;
box on

hold on
plot(tw_d3,bg_d3,'color',[0.4940, 0.1840, 0.5560],'Marker','o','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d2,bg_d2,'color',[0 0.6 0],'Marker','p','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d1,bg_d1,'color',[0 0 1],'Marker','d','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d6,bg_d6,'color',[1 0 0],'Marker','h','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d4,bg_d4,'color',[0.64 0.08 0.18],'Marker','sq','Markersize',10,'LineWidth',1,'LineStyle','-')
plot(tw_d5,bg_d5,'color',[0.95 0.00 0.75],'Marker','^','Markersize',10,'LineWidth',1,'LineStyle','-')

% S1=scatter(tw_d3(4),bg_d3(4),144,'d','Marker','o');S1.MarkerEdgeColor = [0.4940, 0.1840, 0.5560]; S1.MarkerFaceColor = [0.4940, 0.1840, 0.5560];
% S2=scatter(tw_d2(4),bg_d2(4),144,'d','Marker','p');S2.MarkerEdgeColor = [0 0.6 0]; S2.MarkerFaceColor = [0 0.6 0];
% S3=scatter(tw_d1(4),bg_d1(4),144,'d','Marker','d');S3.MarkerEdgeColor = [0 0 1]; S3.MarkerFaceColor = [0 0 1];
% S4=scatter(tw_d6(4),bg_d6(4),144,'d','Marker','h');S4.MarkerEdgeColor = [1 0 0]; S4.MarkerFaceColor = [1 0 0];
% S5=scatter(tw_d4(4),bg_d4(4),144,'d','Marker','sq');S5.MarkerEdgeColor = [0.64 0.08 0.18]; S5.MarkerFaceColor = [0.64 0.08 0.18];
% S6=scatter(tw_d5(4),bg_d5(4),144,'d','Marker','^');S6.MarkerEdgeColor = [0.95 0.00 0.75]; S6.MarkerFaceColor = [0.95 0.00 0.75];

set(gca,'TickLabelInterpreter','LaTex');
set(gca,'XTick',[0.0 0.1 0.2 0.3 0.4],'XMinorTick','on','YTick',[0.0 0.2 0.4 0.6 0.8 1.0],'YMinorTick','on','TickLength',[0.018 0.025],'FontName','Times New Roman','FontSize',20);
set(gca,'XTickLabel',num2str(get(gca,'XTick')','%.1f'))
set(gca,'YTickLabel',num2str(get(gca,'YTick')','%.1f'))
%set(gca,'XTickLabel',{'$0.01$', '$0.02$', '$0.04$'});
%set(gca,'YTickLabel',{'$10^{-2}$', '$10^{-1}$', '$10^{0}$'});
xlim([0.0 0.44]);
ylim([0.0 1.0]);

xlabel('Applied twist (rad/nm)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');
ylabel('Bandgap (eV)','FontSize',20,'FontName','Times New Roman','Interpreter','LaTex');

legend1 = legend('$(16,0)$','$(20,0)$','$(13,13)$','$(18,9)$','$(27,0)$','$(22,11)$','Location','Northeast');%,'Orientation','horizontal'
set(legend1,'fontsize',19.5,'FontName','Times New Roman','Interpreter','LaTex');

%str = 'Slope = 2.0';
%dim = [.2 .58 .3 .3];
%annotation('textbox',dim,'String',str,'FitBoxToText','on');

set(figure1,'Units','Inches');
pos = get(figure1,'Position');
set(figure1,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[4,2])
saveas(gcf,'bandgapVstwist','epsc')
hold off
